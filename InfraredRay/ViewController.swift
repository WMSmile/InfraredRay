//
//  ViewController.swift
//  InfraredRay
//
//  Created by apple on 2017/12/28.
//  Copyright Â© 2017å¹´ wumeng. All rights reserved.
//

import UIKit

class ViewController: UIViewController {

    @IBOutlet weak var rate: UISlider!
    override func viewDidLoad() {
        super.viewDidLoad()
        // Do any additional setup after loading the view, typically from a nib.
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }

    /* nec protocol head */
    let head_h: Int = 4486
    let head_l: Int = 4428
    
    /* nec protocol value 1 */
    let one_h: Int = 590
    let one_l: Int = 1603
    
    /* nec protocol value 0 */
    let zero_h: Int = 590
    let zero_l: Int = 543
    
    let digit: [Character] = ["0", "1"]
    
    // get nec key code -- "1010100"
    func getNecSignalList(keycode: String) -> [Int] {
        let str: String = keycode;
        var array: [Int] = [];
        
        // add space
        //array.add(Signal(2000, isSignal: false))
        
        // add header
        array.append(head_h)
        array.append(head_l)
        
        for c in str {
            switch c {
            case "0":
                array.append(zero_h)
                array.append(zero_l)
            case "1":
                array.append(one_h)
                array.append(one_l)
            default:
                print("default");
                break;
            }
        }
        
        // stop bit
        array.append(zero_h)
        array.append(zero_l)
        
        return array
    }
    
    
    @IBAction func sendSignal(_ sender: Any) {
//        let =private final static String CMD_MIDEA_ON = "4486,4428,590,1604,590,534,563,1605,591,1603,592,533,563,535,563,1604,591,535,563,534,564,1606," +
//        "589,534,563,535,563,1604,590,1603,592,535,563,1604,591,1607,588,535,563,1605,590,1607,588,1604,591," +
//        "1632,564,1602,593,1605,591,534,563,1602,593,534,563,534,563,534,563,535,563,534,563,534,563,1604," +
//        "591,534,563,1632,563,534,564,1604,590,1605,590,534,563,534,564,534,563,1605,591,533,563,1604,591," +
//        "535,563,534,563,1605,590,1604,592,5263,4512,4427,592,1602,593,534,563,1602,593,1632,563,535,563," +
//        "534,563,1605,590,535,564,533,563,1607,589,534,563,534,563,1604,592,1602,593,534,563,1604,591,1630," +
//        "564,534,563,1631,564,1604,591,1604,592,1603,592,1604,591,1633,563,534,563,1604,592,534,563,535,563," +
//        "510,587,534,563,534,564,510,587,1630,565,510,587,1631,564,511,586,1603,592,1604,591,511,587,511," +
//        "587,509,588,1605,590,510,587,1603,593,510,587,511,587,1603,592,1604,591";
//        private final static String CMD_MIDEA_OFF =
//        "4464,4451,567,1628,567,532,565,1628,567,1629,567,531,565,532,567,1626,568,531,566,532,565,1628," +
//        "568,532,565,532,566,1627,568,1630,565,532,566,1627,568,532,566,1629,566,1628,567,1629,567,1628,567," +
//        "532,565,1629,567,1627,568,1628,567,531,567,531,565,532,566,532,565,1627,568,531,566,532,566,1628," +
//        "567,1629,566,1627,568,533,565,532,565,532,566,531,566,532,566,531,565,533,565,532,565,1627,568," +
//        "1629,567,1629,567,1628,567,1627,568,5286,4489,4452,567,1629,566,532,566,1628,568,1627,568,531,566," +
//        "531,566,1628,568,530,566,531,565,1629,567,532,565,532,565,1630,566,1629,567,532,565,1628,567,533," +
//        "565,1629,567,1628,567,1628,592,1604,590,508,577,1616,577,1620,590,1603,567,533,589,508,589,509,589," +
//        "508,589,1603,592,508,590,507,590,1603,591,1633,562,1543,652,509,589,509,588,509,589,508,590,508," +
//        "589,508,590,507,589,508,589,1605,590,1604,591,1604,591,1604,592,1604,592";
        
//        let list = [4464,4451,567,1628,567,532,565,1628,567,1629,567,531,565,532,567,1626,568,531,566,532,565,1628,568,532,565,532,566,1627,568,1630,565,532,566,1627,568,532,566,1629,566,1628,567,1629,567,1628,567,532,565,1629,567,1627,568,1628,567,531,567,531,565,532,566,532,565,1627,568,531,566,532,566,1628,567,1629,566,1627,568,533,565,532,565,532,566,531,566,532,566,531,565,533,565,532,565,1627,568,1629,567,1629,567,1628,567,1627,568,5286,4489,4452,567,1629,566,532,566,1628,568,1627,568,531,566,531,566,1628,568,530,566,531,565,1629,567,532,565,532,565,1630,566,1629,567,532,565,1628,567,533,565,1629,567,1628,567,1628,592,1604,590,508,577,1616,577,1620,590,1603,567,533,589,508,589,509,589,508,589,1603,592,508,590,507,590,1603,591,1633,562,1543,652,509,589,509,588,509,589,508,590,508,589,508,590,507,589,508,589,1605,590,1604,591,1604,591,1604,592,1604,592];
//        let list = [4486,4428,
//                    590,1604, //1
//                    590,534,  //0
//                    563,1605, //1
//                    591,1603, //1
//                    592,533,
//                    563,535,
//                    563,1604,
//                    591,535,
//                    563,534,
//                    564,1606,
//                    589,534,
//                    563,535,
//                    563,1604,
//                    590,1603,
//                    592,535,
//                    563,1604,
//                    591,1607,
//                    588,535,
//                    563,1605,
//                    590,1607,
//                    588,1604,
//                    591,1632,
//                    564,1602,
//                    593,1605,
//                    591,534,
//                    563,1602,
//                    593,534,
//                    563,534,
//                    563,534,
//                    563,535,
//                    563,534,
//                    563,534,
//                    563,1604,
//                    591,534,
//                    563,1632,
//                    563,534,
//                    564,1604,
//                    590,1605,
//                    590,534,
//                    563,534,
//                    564,534,
//                    563,1605,
//                    591,533,
//                    563,1604,
//                    591,535,
//                    563,534,
//                    563,1605,
//                    590,1604,
//                    592,5263,
//                    4512,4427,
//                    592,1602,
//                    593,534,
//                    563,1602,
//                    593,1632,
//                    563,535,
//                    563,534,
//                    563,1605,
//                    590,535,
//                    564,533,
//                    563,1607,
//                    589,534,
//                    563,534,
//                    563,1604,
//                    592,1602,
//                    593,534,
//                    563,1604,
//                    591,1630,
//                    564,534,
//                    563,1631,
//                    564,1604,
//                    591,1604,
//                    592,1603,
//                    592,1604,
//                    591,1633,
//                    563,534,
//                    563,1604,
//                    592,534,
//                    563,535,
//                    563,510,
//                    587,534,
//                    563,534,
//                    564,510,
//                    587,1630,
//                    565,510,
//                    587,1631,
//                    564,511,
//                    586,1603,
//                    592,1604,
//                    591,511,
//                    587,511,
//                    587,509,
//                    588,1605,
//                    590,510,
//                    587,1603,
//                    593,510,
//                    587,511,
//                    587,1603,
//                    592,1604,592,1604]
        
        let list = [4486,4428,590,1604,590,534,563,1605,591,1603,592,533,563,535,563,1604,591,535,563,534,564,1606,589,534,563,535,563,1604,590,1603,592,535,563,1604,591,1607,588,535,563,1605,590,1607,588,1604,591,1632,564,1602,593,1605,591,534,563,1602,593,534,563,534,563,534,563,535,563,534,563,534,563,1604,591,534,563,1632,563,534,564,1604,590,1605,590,534,563,534,564,534,563,1605,591,533,563,1604,591,535,563,534,563,1605,590,1604,592,5263,4512,4427,592,1602,593,534,563,1602,593,1632,563,535,563,534,563,1605,590,535,564,533,563,1607,589,534,563,534,563,1604,592,1602,593,534,563,1604,591,1630,564,534,563,1631,564,1604,591,1604,592,1603,592,1604,591,1633,563,534,563,1604,592,534,563,535,563,510,587,534,563,534,564,510,587,1630,565,510,587,1631,564,511,586,1603,592,1604,591,511,587,511,587,509,588,1605,590,510,587,1603,593,510,587,511,587,1603,592,1604,591]
        
//        var str = "";
//        for i in stride(from: 0, to: list.count-1, by:2 ) {
//            if i >= 2 {
//                if (list[i] - list[i+1]) > 500 || (list[i] - list[i+1]) < -500 {
//                    str.append("1");
//                }
//                else {
//                    str.append("0");
//                }
//            }
//
//        }
//        print("str == \(str) listcount = \(list.count)");
//        let list1 =  self.getNecSignalList(keycode: str);
//        print("list = \(list1) listcount == \(list1.count)");
        
//        let list =  self.getNecSignalList(keycode: "101100100100110110111111010000001010110001010011101011001001001101101111110100000010101100010100111")
        print("list = \(list) listcount == \(list.count)");
//
       
        
        
        
        
        print("rate == \(rate)");
        InfraredRayManger.getinstance.rate = Double(self.rate.value);
        InfraredRayManger.getinstance.sendSignal(list);
        
    }
    
    
    
    
}

